<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Performance Review Phrases - Your Custom Report</title>
    <meta name="description" content="Your personalized performance review phrases generated by our HRMS CRM Tool. Copy and use them for effective employee feedback.">
    <meta property="og:title" content="Performance Review Phrases - Your Custom Report">
    <meta property="og:description" content="Your personalized performance review phrases generated by our HRMS CRM Tool. Copy and use them for effective employee feedback.">
    <meta property="og:type" content="website">
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="../performance-review-phrase-generator/style.css">
</head>
<body class="bg-gray-100 font-sans antialiased">
    <div class="container mx-auto p-4">
        <header class="text-center my-8">
            <h1 class="text-4xl font-bold text-gray-800">Your Personalized Performance Review Phrases</h1>
            <p class="text-lg text-gray-600 mt-2">Generated for <span id="displayEmployeeName" class="font-semibold"></span></p>
        </header>

        <main class="bg-white p-6 rounded-lg shadow-md">
            <section id="inputSummary" class="mb-8 p-4 bg-gray-50 rounded-md">
                <h2 class="text-xl font-bold text-gray-800 mb-3">Summary of Your Inputs:</h2>
                <p><strong>Performance Area:</strong> <span id="summaryPerformanceArea"></span></p>
                <p><strong>Performance Level:</strong> <span id="summaryPerformanceLevel"></span></p>
                <p><strong>Feedback Tone:</strong> <span id="summaryFeedbackTone"></span></p>
                <p id="summarySpecificAchievementContainer"><strong>Specific Achievement:</strong> <span id="summarySpecificAchievement"></span></p>
            </section>

            <section id="results" class="mb-8">
                <h2 class="text-2xl font-bold text-gray-800 mb-4">Generated Phrases</h2>
                <div id="phraseOutput" class="space-y-4">
                    <!-- Generated phrases will be inserted here -->
                </div>
                <button id="copyAllButton" class="mt-4 bg-green-600 text-white p-2 rounded-md hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500">Copy All Phrases</button>
            </section>

            <section id="leadCapture" class="mt-8 bg-gray-50 p-6 rounded-lg shadow-inner">
                <h2 class="text-xl font-bold text-gray-800 mb-3">Unlock More Phrases & Tips!</h2>
                <p class="text-gray-600 mb-4">Enter your email to receive an enhanced report with even more performance review phrases and expert tips.</p>
                <form id="leadCaptureForm" class="flex flex-col sm:flex-row gap-2">
                    <input type="email" id="leadEmail" placeholder="your.email@example.com" class="flex-grow p-2 border border-gray-300 rounded-md shadow-sm focus:ring-indigo-500 focus:border-indigo-500">
                    <button type="submit" class="bg-blue-600 text-white p-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500">Get Enhanced Report</button>
                </form>
                <p id="leadCaptureMessage" class="mt-2 text-sm text-green-600 hidden"></p>
            </section>
        </main>
    </div>

    <script>
        // Analytics Logging (Placeholder - In a real scenario, this would send data to an analytics service)
        function logAnalyticsEvent(eventName, data = {}) {
            console.log(`Analytics Event: ${eventName}`, data);
            // Example: fetch('/api/log-analytics', { method: 'POST', body: JSON.stringify({ eventName, data }) });
        }

        document.addEventListener('DOMContentLoaded', () => {
            logAnalyticsEvent('ToolResultViewed', { tool: 'PerformanceReviewPhraseGenerator' });

            const params = new URLSearchParams(window.location.search);
            const encodedData = params.get('data');

            if (encodedData) {
                try {
                    const decodedData = JSON.parse(atob(encodedData));
                    const { employeeName, performanceArea, performanceLevel, feedbackTone, specificAchievement, phrases } = decodedData;

                    document.getElementById('displayEmployeeName').textContent = employeeName || 'The Employee';
                    document.getElementById('summaryPerformanceArea').textContent = performanceArea;
                    document.getElementById('summaryPerformanceLevel').textContent = performanceLevel;
                    document.getElementById('summaryFeedbackTone').textContent = feedbackTone;
                    
                    const summarySpecificAchievementContainer = document.getElementById('summarySpecificAchievementContainer');
                    if (specificAchievement) {
                        document.getElementById('summarySpecificAchievement').textContent = specificAchievement;
                        summarySpecificAchievementContainer.classList.remove('hidden');
                    } else {
                        summarySpecificAchievementContainer.classList.add('hidden');
                    }

                    const phraseOutput = document.getElementById('phraseOutput');
                    phraseOutput.innerHTML = '';
                    if (phrases.length === 0) {
                        phraseOutput.innerHTML = '<p class="text-gray-500">No phrases found for the selected criteria. Try different options.</p>';
                    } else {
                        phrases.forEach(phrase => {
                            const phraseDiv = document.createElement('div');
                            phraseDiv.className = 'bg-gray-50 p-3 rounded-md flex justify-between items-center';
                            phraseDiv.innerHTML = `
                                <p class="text-gray-800 flex-grow">${phrase}</p>
                                <button class="copy-btn ml-4 bg-gray-200 text-gray-700 px-3 py-1 rounded-md hover:bg-gray-300" data-phrase="${phrase}">Copy</button>
                            `;
                            phraseOutput.appendChild(phraseDiv);
                        });

                        document.querySelectorAll('.copy-btn').forEach(button => {
                            button.addEventListener('click', (e) => {
                                const phraseToCopy = e.target.dataset.phrase;
                                navigator.clipboard.writeText(phraseToCopy).then(() => {
                                    e.target.textContent = 'Copied!';
                                    setTimeout(() => e.target.textContent = 'Copy', 2000);
                                }).catch(err => {
                                    console.error('Failed to copy: ', err);
                                });
                            });
                        });

                        const copyAllButton = document.getElementById('copyAllButton');
                        copyAllButton.addEventListener('click', () => {
                            const allPhrases = Array.from(document.querySelectorAll('#phraseOutput p'))
                                                    .map(p => p.textContent)
                                                    .join('\n\n');
                            navigator.clipboard.writeText(allPhrases).then(() => {
                                copyAllButton.textContent = 'All Copied!';
                                setTimeout(() => copyAllButton.textContent = 'Copy All Phrases', 2000);
                            }).catch(err => {
                                console.error('Failed to copy all: ', err);
                            });
                        });
                    }
                } catch (error) {
                    console.error('Error decoding or parsing data:', error);
                    document.getElementById('phraseOutput').innerHTML = '<p class="text-red-500">Error loading phrases. Please try again from the <a href="../performance-review-phrase-generator/index.html" class="text-blue-600 hover:underline">generator page</a>.</p>';
                }
            } else {
                document.getElementById('phraseOutput').innerHTML = '<p class="text-red-500">No data found. Please use the <a href="../performance-review-phrase-generator/index.html" class="text-blue-600 hover:underline">generator page</a> to create phrases.</p>';
            }

            const leadCaptureForm = document.getElementById('leadCaptureForm');
            const leadEmailInput = document.getElementById('leadEmail');
            const leadCaptureMessage = document.getElementById('leadCaptureMessage');

            leadCaptureForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const email = leadEmailInput.value.trim();
                if (email) {
                    logAnalyticsEvent('LeadCaptured', { tool: 'PerformanceReviewPhraseGenerator', email: email });
                    leadCaptureMessage.textContent = 'Thank you! Your enhanced report will be sent to ' + email;
                    leadCaptureMessage.classList.remove('hidden');
                    leadEmailInput.value = ''; // Clear the input
                    // In a real application, you would send this email to a backend service
                } else {
                    alert('Please enter a valid email address.');
                }
            });
        });
    </script>
</body>
</html>